2025-02-26 22:21
Tags: #AbstractSyntaxTree

Абстрактное синтаксическое дерево (Abstract Syntax Tree, AST) — это структура данных, которая представляет собой иерархическое представление исходного кода программы. Оно создается на основе лексического анализа и синтаксического анализа (парсинга).

JavaScript-движок (например, V8 в Chrome или SpiderMonkey в Firefox) проходит через несколько этапов для выполнения вашего кода:

Документ --> Лексический анализ --> Синтаксический анализ --> AST

---

### Лексический анализ

На этом этапе исходный код преобразуется в последовательность токенов (лексем). Токены — это базовые элементы языка, такие как ключевые слова (`let`, `if`), операторы (`+`, `-`), числа, строки и т.д.

Исходный код:
```js
let a = 5 + 3;
```

Токены:
```json
[ 'let', 'a', '=', '5', '+', '3', ';' ]
```

---

### Синтаксический анализ (Parsing)

На этом этапе токены преобразуются в абстрактное синтаксическое дерево (AST). Парсер проверяет правильность синтаксиса и строит дерево, которое отражает структуру программы.

```json
{
  "type": "Program",
  "body": [
    {
      "type": "VariableDeclaration",
      "declarations": [
        {
          "type": "VariableDeclarator",
          "id": {
            "type": "Identifier",
            "name": "a"
          },
          "init": {
            "type": "BinaryExpression",
            "operator": "+",
            "left": {
              "type": "NumericLiteral",
              "value": 5
            },
            "right": {
              "type": "NumericLiteral",
              "value": 3
            }
          }
        }
      ],
      "kind": "let"
    }
  ]
}
```

```json
Program
└── VariableDeclaration
    └── VariableDeclarator
        ├── Identifier: a
        └── BinaryExpression
            ├── Left: NumericLiteral: 5
            ├── Operator: +
            └── Right: NumericLiteral: 3
```

---

### Кодогенерация (Code Generation)

На этом этапе движок генерирует байт-код или машинный код из AST. Этот код затем выполняется непосредственно процессором или виртуальной машиной.

---

### Оптимизация и выполнение

Движок JavaScript (например, V8) использует JIT-компилятор (Just-In-Time Compiler) для оптимизации кода во время выполнения. Он анализирует, какие части кода выполняются чаще всего, и компилирует их в более эффективный машинный код.

---
### Links
[[JavaScript]]
